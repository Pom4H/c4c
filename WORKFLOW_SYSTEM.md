# üîÑ Workflow System - Visual Programming from Contracts

## –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–†–∞–∑ —É –∫–∞–∂–¥–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –µ—Å—Ç—å **—Å—Ç—Ä–æ–≥–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ input –∏ output** —á–µ—Ä–µ–∑ Zod-—Å—Ö–µ–º—ã, –∏—Ö –º–æ–∂–Ω–æ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –≤ –Ω–æ–¥—ã –¥–ª—è workflow-—Å–∏—Å—Ç–µ–º—ã**.

**–û–¥–∏–Ω contract ‚Üí –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π:**
- ‚úÖ RPC endpoint
- ‚úÖ REST endpoint
- ‚úÖ CLI command
- ‚úÖ OpenAPI schema
- ‚úÖ **Workflow node** ‚≠ê

---

## üéØ –§–∏–ª–æ—Å–æ—Ñ–∏—è

```
Contract (Zod schema)
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Procedure     ‚îÇ
‚îÇ  input  output  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚Üì
    Workflow Node
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  Input  ‚îÇ
    ‚îÇ   ‚Üì‚Üì    ‚îÇ
    ‚îÇ [LOGIC] ‚îÇ
    ‚îÇ   ‚Üì‚Üì    ‚îÇ
    ‚îÇ Output  ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö–∞–∂–¥–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ = –≥–æ—Ç–æ–≤–∞—è –Ω–æ–¥–∞ –¥–ª—è workflow!**

---

## üöÄ Quick Start

### 1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∫–∞–∫ –æ–±—ã—á–Ω–æ

```typescript
// src/contracts/users.ts
export const createUserContract: Contract = {
  name: "users.create",
  input: z.object({
    name: z.string(),
    email: z.string().email(),
  }),
  output: z.object({
    id: z.string(),
    name: z.string(),
    email: z.string(),
  }),
};
```

### 2. –û–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è workflow-–Ω–æ–¥–∞–º–∏!

```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä
open http://localhost:3000/workflow/palette

# –ò–ª–∏ –ø–æ–ª—É—á–∏—Ç–µ JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
curl http://localhost:3000/workflow/ui-config
```

### 3. –°–æ–∑–¥–∞–π—Ç–µ workflow –∏–∑ –Ω–æ–¥

```typescript
const workflow: WorkflowDefinition = {
  id: "user-registration",
  name: "User Registration",
  version: "1.0.0",
  startNode: "create-user",
  nodes: [
    {
      id: "create-user",
      type: "procedure",
      procedureName: "users.create", // ‚Üê –í–∞—à–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞!
      config: {},
      next: "send-welcome-email",
    },
    {
      id: "send-welcome-email",
      type: "procedure",
      procedureName: "emails.send",
      config: { template: "welcome" },
      next: undefined,
    },
  ],
};
```

### 4. –í—ã–ø–æ–ª–Ω–∏—Ç–µ workflow

```bash
curl -X POST http://localhost:3000/workflow/execute \
  -d '{
    "workflow": { ...workflow definition... },
    "input": {
      "name": "Alice",
      "email": "alice@example.com"
    }
  }'
```

---

## üìä Features

### ‚úÖ Automatic Node Generation

**From:** Procedure with Zod schemas  
**To:** Workflow node with:
- Input ports (from input schema)
- Output ports (from output schema)
- Configuration panel
- Visual representation
- Drag-and-drop capability

### ‚úÖ Multiple Node Types

#### 1. Procedure Node
Executes a registered procedure:
```typescript
{
  id: "my-node",
  type: "procedure",
  procedureName: "users.create",
  config: { /* override inputs */ },
  next: "next-node-id"
}
```

#### 2. Condition Node
Branches based on condition:
```typescript
{
  id: "check-premium",
  type: "condition",
  config: {
    expression: "subscription === 'premium'",
    trueBranch: "advanced-features",
    falseBranch: "basic-features"
  }
}
```

#### 3. Parallel Node
Execute multiple branches in parallel:
```typescript
{
  id: "parallel-tasks",
  type: "parallel",
  config: {
    branches: ["task-1", "task-2", "task-3"],
    waitForAll: true
  },
  next: "aggregate"
}
```

#### 4. Sequential Node
Chain nodes sequentially:
```typescript
{
  id: "step-1",
  type: "sequential",
  next: "step-2"
}
```

### ‚úÖ Runtime Execution

```typescript
import { executeWorkflow } from "./workflow/runtime.js";

const result = await executeWorkflow(workflow, registry, initialInput);

// Result:
// {
//   executionId: "wf_exec_...",
//   status: "completed",
//   outputs: { /* outputs from each node */ },
//   executionTime: 1234,
//   nodesExecuted: ["node1", "node2", "node3"]
// }
```

### ‚úÖ Visual UI Generation

```typescript
import { generateWorkflowUI } from "./workflow/generator.js";

// Generate node palette for visual editor
const uiConfig = generateWorkflowUI(registry);

// Result:
// {
//   nodes: [
//     {
//       id: "users.create",
//       name: "Create User",
//       category: "users",
//       icon: "üë§",
//       color: "#3b82f6",
//       inputSchema: { ... },
//       outputSchema: { ... }
//     },
//     ...
//   ],
//   categories: ["users", "posts", "auth", ...]
// }
```

### ‚úÖ Multiple Export Formats

#### React Flow
```typescript
import { generateReactFlowConfig } from "./workflow/generator.js";

const config = generateReactFlowConfig(registry);
// ‚Üí React Flow compatible node/edge configuration
```

#### n8n
```typescript
import { generateN8NConfig } from "./workflow/generator.js";

const nodes = generateN8NConfig(registry);
// ‚Üí n8n compatible node definitions
```

#### Mermaid
```typescript
import { generateMermaidDiagram } from "./workflow/generator.js";

const diagram = generateMermaidDiagram(registry);
// ‚Üí Mermaid flowchart syntax
```

---

## üé® HTTP Endpoints

### GET /workflow/palette
Visual node palette (HTML)
```bash
open http://localhost:3000/workflow/palette
```

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ø–∞–ª–∏—Ç—Ä–∞ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –Ω–æ–¥ —Å:
- –ö–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ (users, posts, auth, etc.)
- –û–ø–∏—Å–∞–Ω–∏—è–º–∏
- Drag-and-drop functionality
- –¶–≤–µ—Ç–æ–≤–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π

### GET /workflow/ui-config
JSON configuration for UI builders
```bash
curl http://localhost:3000/workflow/ui-config
```

Returns:
```json
{
  "nodes": [
    {
      "id": "users.create",
      "name": "Create User",
      "description": "Create a new user",
      "category": "users",
      "icon": "üë§",
      "color": "#3b82f6",
      "inputSchema": { ... },
      "outputSchema": { ... }
    }
  ],
  "categories": ["users", "posts", "math"]
}
```

### POST /workflow/execute
Execute a workflow
```bash
curl -X POST http://localhost:3000/workflow/execute \
  -H "Content-Type: application/json" \
  -d '{
    "workflow": {
      "id": "my-workflow",
      "name": "My Workflow",
      "version": "1.0.0",
      "startNode": "node-1",
      "nodes": [...]
    },
    "input": {
      "key": "value"
    }
  }'
```

Returns:
```json
{
  "executionId": "wf_exec_1234567890_abc123",
  "status": "completed",
  "outputs": {
    "node-1": { ... },
    "node-2": { ... }
  },
  "executionTime": 1234,
  "nodesExecuted": ["node-1", "node-2"]
}
```

### POST /workflow/validate
Validate a workflow
```bash
curl -X POST http://localhost:3000/workflow/validate \
  -H "Content-Type: application/json" \
  -d '{ "workflow": { ... } }'
```

Returns:
```json
{
  "valid": false,
  "errors": [
    "Node node-1: procedure users.xyz not found in registry",
    "Node node-2: next node node-999 not found"
  ]
}
```

---

## üìö Example Workflows

### Simple Sequential Workflow

```typescript
const mathWorkflow: WorkflowDefinition = {
  id: "math-calculation",
  name: "Math Calculation",
  version: "1.0.0",
  startNode: "add",
  nodes: [
    {
      id: "add",
      type: "procedure",
      procedureName: "math.add",
      config: { a: 10, b: 5 },
      next: "multiply"
    },
    {
      id: "multiply",
      type: "procedure",
      procedureName: "math.multiply",
      config: { a: 2 },
      // b will come from previous step's output
      next: undefined
    }
  ]
};

// Execute
const result = await executeWorkflow(mathWorkflow, registry);
// outputs.multiply.result = (10 + 5) * 2 = 30
```

### Conditional Branching

```typescript
const conditionalWorkflow: WorkflowDefinition = {
  id: "user-tier-processing",
  name: "User Tier Processing",
  version: "1.0.0",
  startNode: "get-user",
  nodes: [
    {
      id: "get-user",
      type: "procedure",
      procedureName: "users.get",
      next: "check-tier"
    },
    {
      id: "check-tier",
      type: "condition",
      config: {
        expression: "tier === 'premium'",
        trueBranch: "premium-processing",
        falseBranch: "basic-processing"
      }
    },
    {
      id: "premium-processing",
      type: "procedure",
      procedureName: "process.premium",
      next: "save"
    },
    {
      id: "basic-processing",
      type: "procedure",
      procedureName: "process.basic",
      next: "save"
    },
    {
      id: "save",
      type: "procedure",
      procedureName: "storage.save",
      next: undefined
    }
  ]
};
```

### Parallel Execution

```typescript
const parallelWorkflow: WorkflowDefinition = {
  id: "parallel-tasks",
  name: "Parallel Tasks",
  version: "1.0.0",
  startNode: "parallel",
  nodes: [
    {
      id: "parallel",
      type: "parallel",
      config: {
        branches: ["task-1", "task-2", "task-3"],
        waitForAll: true
      },
      next: "aggregate"
    },
    {
      id: "task-1",
      type: "procedure",
      procedureName: "math.add",
      config: { a: 1, b: 2 }
    },
    {
      id: "task-2",
      type: "procedure",
      procedureName: "math.multiply",
      config: { a: 3, b: 4 }
    },
    {
      id: "task-3",
      type: "procedure",
      procedureName: "math.add",
      config: { a: 5, b: 6 }
    },
    {
      id: "aggregate",
      type: "procedure",
      procedureName: "math.add",
      next: undefined
    }
  ]
};
```

---

## üé® Visual Editor Integration

### React Flow Example

```tsx
import ReactFlow from 'reactflow';
import { generateReactFlowConfig } from 'tsdev/workflow/generator';

function WorkflowEditor() {
  const { nodeTypes, edgeTypes } = generateReactFlowConfig(registry);
  
  return (
    <ReactFlow
      nodeTypes={nodeTypes}
      edgeTypes={edgeTypes}
      nodes={nodes}
      edges={edges}
    />
  );
}
```

### Custom UI Builder

```typescript
// Fetch available nodes
const response = await fetch('http://localhost:3000/workflow/ui-config');
const { nodes, categories } = await response.json();

// Build UI
categories.forEach(category => {
  const categoryNodes = nodes.filter(n => n.category === category);
  
  // Render category
  renderCategory(category, categoryNodes);
});

// Each node shows:
// - Icon
// - Name
// - Description
// - Input/output ports (from schemas)
// - Draggable for workflow builder
```

---

## üìä OpenTelemetry Integration

### –ü–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ workflow

**Workflow –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å OpenTelemetry –∏–∑ –∫–æ—Ä–æ–±–∫–∏!**

–ö–∞–∂–¥–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ workflow —Å–æ–∑–¥–∞—ë—Ç –∏–µ—Ä–∞—Ä—Ö–∏—é spans:

```
workflow.execute (root span)
  ‚îú‚îÄ workflow.node.procedure (node-1)
  ‚îÇ  ‚îî‚îÄ users.create (procedure span from withSpan)
  ‚îÇ     ‚îî‚îÄ [business logic]
  ‚îú‚îÄ workflow.node.condition
  ‚îÇ  ‚îî‚îÄ [condition evaluation]
  ‚îî‚îÄ workflow.node.procedure (node-2)
     ‚îî‚îÄ emails.send (procedure span from withSpan)
        ‚îî‚îÄ [email logic]
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞—Ç—Ä–∏–±—É—Ç—ã

#### Workflow-level attributes:
```typescript
{
  "workflow.id": "user-onboarding",
  "workflow.name": "User Onboarding",
  "workflow.version": "1.0.0",
  "workflow.execution_id": "wf_exec_1234567890_abc123",
  "workflow.start_node": "create-user",
  "workflow.node_count": 5,
  "workflow.nodes_executed_total": 5,
  "workflow.execution_time_ms": 1234,
  "workflow.status": "completed"
}
```

#### Node-level attributes:
```typescript
{
  "node.id": "create-user",
  "node.type": "procedure",
  "node.procedure": "users.create",
  "node.status": "completed",
  "node.next": "send-email",
  "procedure.input": "{\"name\":\"Alice\",\"email\":\"alice@example.com\"}",
  "procedure.output": "{\"id\":\"123\",\"name\":\"Alice\"}"
}
```

#### Condition-level attributes:
```typescript
{
  "condition.expression": "subscription === 'premium'",
  "condition.variables": "{\"subscription\":\"premium\"}",
  "condition.result": true,
  "condition.branch_taken": "premium-features"
}
```

#### Parallel execution attributes:
```typescript
{
  "parallel.node_id": "parallel-tasks",
  "parallel.branch_id": "task-1",
  "parallel.branch_index": 0
}
```

### Policies —Ä–∞–±–æ—Ç–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

–ü—Ä–æ—Ü–µ–¥—É—Ä—ã –≤ workflow –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–µ –∂–µ policies, —á—Ç–æ –∏ –≤ –æ–±—ã—á–Ω—ã—Ö –≤—ã–∑–æ–≤–∞—Ö:

```typescript
export const createUser: Procedure = {
  contract: createUserContract,
  handler: applyPolicies(
    baseHandler,
    withLogging("users.create"),
    withSpan("users.create"),  // ‚Üê –°–æ–∑–¥–∞—ë—Ç span –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    withRetry({ maxAttempts: 3 })
  )
};

// –í workflow —ç—Ç–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ —Å–æ–∑–¥–∞—Å—Ç span –∫–∞–∫ child node span
```

### Span Hierarchy Example

```
Trace ID: abc123def456
‚îÇ
‚îî‚îÄ workflow.execute (1234ms)
   ‚îÇ  workflow.id: "user-registration"
   ‚îÇ  workflow.status: "completed"
   ‚îÇ
   ‚îú‚îÄ workflow.node.procedure (234ms)
   ‚îÇ  ‚îÇ  node.id: "create-user"
   ‚îÇ  ‚îÇ  node.procedure: "users.create"
   ‚îÇ  ‚îÇ
   ‚îÇ  ‚îî‚îÄ users.create (220ms)  ‚Üê from withSpan policy
   ‚îÇ     ‚îÇ  request.id: "req_..."
   ‚îÇ     ‚îÇ  context.transport: "workflow"
   ‚îÇ     ‚îÇ  context.workflowId: "user-registration"
   ‚îÇ     ‚îÇ
   ‚îÇ     ‚îî‚îÄ [business logic execution]
   ‚îÇ
   ‚îú‚îÄ workflow.node.condition (5ms)
   ‚îÇ     condition.expression: "emailVerified === true"
   ‚îÇ     condition.result: true
   ‚îÇ
   ‚îî‚îÄ workflow.node.procedure (456ms)
      ‚îÇ  node.id: "send-welcome"
      ‚îÇ  node.procedure: "emails.send"
      ‚îÇ
      ‚îî‚îÄ emails.send (445ms)  ‚Üê from withSpan policy
         ‚îî‚îÄ [email sending logic]
```

### Viewing Traces

–†–∞–±–æ—Ç–∞–µ—Ç —Å–æ –≤—Å–µ–º–∏ OpenTelemetry-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏:

**Jaeger:**
```bash
# View trace in Jaeger UI
http://localhost:16686/trace/<trace-id>
```

**DataDog:**
```bash
# Spans appear in APM > Traces
# Filter by: service:tsdev, operation:workflow.execute
```

**Honeycomb:**
```bash
# Query:
# WHERE workflow.id = "user-registration"
# GROUP BY node.id
```

### Error Tracking

–ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö traces —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:

```typescript
{
  "workflow.status": "failed",
  "workflow.error": "User with email alice@example.com already exists",
  "node.status": "failed",
  "node.error": "Duplicate email",
  "error.type": "ValidationError",
  "error.stack": "..."
}
```

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
// –í—ã–ø–æ–ª–Ω–∏ workflow
const result = await executeWorkflow(workflow, registry, input);

// Trace –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω!
// –°–º–æ—Ç—Ä–∏ –≤ Jaeger/DataDog/etc:
// - –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
// - –í—Ä–µ–º—è –∫–∞–∂–¥–æ–π –Ω–æ–¥—ã
// - Input/output –¥–∞–Ω–Ω—ã–µ
// - –û—à–∏–±–∫–∏ —Å stack traces
```

## üîß Advanced Features

### Error Handling

```typescript
{
  id: "risky-node",
  type: "procedure",
  procedureName: "risky.operation",
  onError: "error-handler", // ‚Üê Error handling node
  next: "success-handler"
}
```

### Variables & Context

```typescript
const workflow: WorkflowDefinition = {
  variables: {
    userId: "123",
    environment: "production"
  },
  nodes: [
    {
      id: "node-1",
      type: "procedure",
      procedureName: "users.get",
      config: {
        // Can reference workflow variables
        id: "${userId}"
      }
    }
  ]
};
```

### Node Output Storage

```typescript
// During execution, outputs are stored in context
context.nodeOutputs.get("node-1"); // ‚Üí output from node-1

// Next nodes can access previous outputs
// via context.variables (automatically merged)
```

---

## üí° Use Cases

### 1. **Low-Code Platforms**
–ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç–µ tsdev –≤ low-code platform:
- –í–∏–∑—É–∞–ª—å–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä workflow
- Drag-and-drop –Ω–æ–¥—ã
- Non-technical users —Å–æ–∑–¥–∞—é—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É

### 2. **API Orchestration**
–ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ multiple API calls –≤ workflow:
```
Get User ‚Üí Check Subscription ‚Üí Send Email ‚Üí Update Analytics
```

### 3. **Data Pipelines**
ETL –ø—Ä–æ—Ü–µ—Å—Å—ã –∫–∞–∫ workflow:
```
Extract ‚Üí Transform ‚Üí Validate ‚Üí Load ‚Üí Notify
```

### 4. **Business Process Automation**
–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤:
```
Order Created ‚Üí Check Inventory ‚Üí Process Payment ‚Üí Ship ‚Üí Send Confirmation
```

### 5. **Testing Scenarios**
Integration —Ç–µ—Å—Ç—ã –∫–∞–∫ workflow:
```
Setup ‚Üí Create User ‚Üí Login ‚Üí Perform Action ‚Üí Verify ‚Üí Cleanup
```

---

## üéØ Benefits

### ‚úÖ Zero Additional Code
- Procedures —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
- Workflow –Ω–æ–¥—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- No manual node registration

### ‚úÖ Type Safety
- Input/output –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ Zod
- TypeScript types –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- Runtime validation –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω

### ‚úÖ Reusability
- –û–¥–Ω–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ = –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
- –í RPC, REST, CLI, **–∏ workflow**
- Single source of truth

### ‚úÖ Visual Programming
- Drag-and-drop interface
- Visual debugging
- Easy to understand complex flows

### ‚úÖ Observability
- Workflow execution tracking
- Each node traced via OpenTelemetry
- Clear execution logs

---

## üèóÔ∏è Architecture

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ          Procedure Registry             ‚îÇ
‚îÇ  (Auto-discovered from handlers/)       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ                   ‚îÇ
     ‚ñº                   ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Runtime ‚îÇ      ‚îÇ UI Generator   ‚îÇ
‚îÇ Executor‚îÇ      ‚îÇ                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ                   ‚îÇ
     ‚ñº                   ‚ñº
Execute           Visual Editor
Workflows         Configuration
```

### Components

1. **Workflow Runtime** (`src/workflow/runtime.ts`)
   - Executes workflows
   - Manages execution context
   - Handles conditions, parallelism
   - Validates workflows

2. **UI Generator** (`src/workflow/generator.ts`)
   - Generates node palette
   - Creates React Flow config
   - Exports n8n format
   - Generates Mermaid diagrams

3. **HTTP Adapter** (`src/adapters/workflow-http.ts`)
   - `/workflow/palette` - Visual editor
   - `/workflow/ui-config` - JSON config
   - `/workflow/execute` - Execute workflows
   - `/workflow/validate` - Validate workflows

---

## üöÄ Future Enhancements

- [ ] Visual workflow editor (React-based)
- [ ] Workflow versioning
- [ ] Workflow scheduling (cron-like)
- [ ] Sub-workflows (nested workflows)
- [ ] Workflow templates library
- [ ] Monitoring dashboard
- [ ] Webhook triggers
- [ ] Event-driven execution
- [ ] Workflow marketplace

---

## üìñ Summary

**–ö–æ–Ω—Ü–µ–ø—Ü–∏—è:**  
–ü—Ä–æ—Ü–µ–¥—É—Ä—ã —Å Zod-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º–∏ ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è workflow-–Ω–æ–¥–∞–º–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
- ‚úÖ Visual programming platform
- ‚úÖ Low-code capabilities
- ‚úÖ Type-safe workflows
- ‚úÖ Reusable procedures
- ‚úÖ Multiple export formats
- ‚úÖ Zero boilerplate

**One Contract ‚Üí Everything:**
1. RPC endpoint
2. REST endpoint  
3. CLI command
4. OpenAPI schema
5. **Workflow node** ‚≠ê

**"Write once ‚Äî describe forever"** —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ! ‚ú®
