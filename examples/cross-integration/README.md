# ğŸ”„ Cross-Integration Example

Ğ”ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ´Ğ²ÑƒÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ğ½ĞµĞ³Ğ¾ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ´Ğ²ÑƒĞ¼Ñ c4c Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸ÑĞ¼Ğ¸ Ñ‡ĞµÑ€ĞµĞ· OpenAPI ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸.

## ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         App A: Task Manager             â”‚
â”‚                                         â”‚
â”‚  Procedures:                            â”‚
â”‚  - tasks.create                         â”‚
â”‚  - tasks.list                           â”‚
â”‚  - tasks.update                         â”‚
â”‚                                         â”‚
â”‚  Triggers:                              â”‚
â”‚  - task.created (webhook)               â”‚
â”‚  - task.updated (webhook)               â”‚
â”‚                                         â”‚
â”‚  Port: 3001                             â”‚
â”‚  OpenAPI: http://localhost:3001/openapi.json
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†•
            c4c integrate
                    â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    App B: Notification Service          â”‚
â”‚                                         â”‚
â”‚  Procedures:                            â”‚
â”‚  - notifications.send                   â”‚
â”‚  - notifications.list                   â”‚
â”‚  - notifications.subscribe              â”‚
â”‚                                         â”‚
â”‚  Triggers:                              â”‚
â”‚  - notification.sent (webhook)          â”‚
â”‚                                         â”‚
â”‚  Port: 3002                             â”‚
â”‚  OpenAPI: http://localhost:3002/openapi.json
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### 1. Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¾Ğ±Ğ¾Ğ¸Ñ… Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹

```bash
# Terminal 1: App A
cd examples/cross-integration/app-a
pnpm install
pnpm dev  # Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑÑ Ğ½Ğ° :3001

# Terminal 2: App B
cd examples/cross-integration/app-b
pnpm install
pnpm dev  # Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑÑ Ğ½Ğ° :3002
```

### 2. Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ App A â†’ App B

```bash
cd examples/cross-integration/app-b

# Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ€ÑƒĞµĞ¼ App A Ğ² App B
c4c integrate http://localhost:3001/openapi.json --name task-manager

# Ğ¢ĞµĞ¿ĞµÑ€ÑŒ App B Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ†ĞµĞ´ÑƒÑ€Ñ‹ App A!
```

### 3. Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ App B â†’ App A

```bash
cd examples/cross-integration/app-a

# Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ€ÑƒĞµĞ¼ App B Ğ² App A
c4c integrate http://localhost:3002/openapi.json --name notifications

# Ğ¢ĞµĞ¿ĞµÑ€ÑŒ App A Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ†ĞµĞ´ÑƒÑ€Ñ‹ App B!
```

### 4. Ğ’Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ

ĞŸĞ¾ÑĞ»Ğµ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸:

**App A Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑ‚ÑŒ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· App B:**
```typescript
// Ğ’ app-a/workflows/task-workflow.ts
steps: [
  {
    id: 'create-task',
    procedure: 'tasks.create',
    input: { title: 'New task' },
  },
  {
    id: 'notify',
    procedure: 'notifications.send', // â† ĞŸÑ€Ğ¾Ñ†ĞµĞ´ÑƒÑ€Ğ° Ğ¸Ğ· App B!
    input: {
      message: 'New task created: {{ steps.create-task.output.title }}',
    },
  },
]
```

**App B Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ¸Ğ· App A:**
```typescript
// Ğ’ app-b/workflows/notification-workflow.ts
steps: [
  {
    id: 'get-tasks',
    procedure: 'task-manager.tasks.list', // â† ĞŸÑ€Ğ¾Ñ†ĞµĞ´ÑƒÑ€Ğ° Ğ¸Ğ· App A!
  },
  {
    id: 'send-summary',
    procedure: 'notifications.send',
    input: {
      message: 'You have {{ steps.get-tasks.output.length }} tasks',
    },
  },
]
```

## Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¸

### Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ 1: ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ¾ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ°Ñ…

1. ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ ÑĞ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ Ğ² App A
2. App A Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€ `task.created` ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚
3. Workflow Ğ² App A Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ `notifications.send` (Ğ¸Ğ· App B)
4. App B Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ

### Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ 2: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ¿Ğ¾ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ

1. App B Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ workflow
2. Ğ’Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ `task-manager.tasks.list` (Ğ¸Ğ· App A)
3. Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ÑƒĞµÑ‚ Ğ¿Ñ€Ğ¾ÑÑ€Ğ¾Ñ‡ĞµĞ½Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸
4. ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· `notifications.send`

## OpenAPI ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸

ĞĞ±Ğ° Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒÑÑ‚ ÑĞ²Ğ¾Ğ¸ ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸:

- App A: http://localhost:3001/openapi.json
- App B: http://localhost:3002/openapi.json

Ğ¡Ğ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸ Ğ²ĞºĞ»ÑÑ‡Ğ°ÑÑ‚:
- âœ… Ğ’ÑĞµ procedure endpoints (REST + RPC)
- âœ… Webhooks Ğ´Ğ»Ñ Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ğ¾Ğ²
- âœ… ĞœĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ c4c (`x-c4c-triggers`)
- âœ… ĞŸĞ¾Ğ»Ğ½Ñ‹Ğµ ÑÑ…ĞµĞ¼Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

## Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
cross-integration/
â”œâ”€â”€ app-a/                      # Task Manager
â”‚   â”œâ”€â”€ package.json            # c4c serve Ğ² scripts
â”‚   â”œâ”€â”€ procedures/
â”‚   â”‚   â””â”€â”€ tasks.ts           # CRUD Ğ´Ğ»Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡ + Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹
â”‚   â”œâ”€â”€ workflows/
â”‚   â”‚   â””â”€â”€ task-workflow.ts   # Workflow Ñ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸ÑĞ¼Ğ¸
â”‚   â””â”€â”€ generated/             # ĞŸĞ¾ÑĞ»Ğµ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ App B
â”‚       â””â”€â”€ notifications/
â”‚           â”œâ”€â”€ sdk.gen.ts
â”‚           â”œâ”€â”€ types.gen.ts
â”‚           â””â”€â”€ procedures.gen.ts
â”‚
â”œâ”€â”€ app-b/                      # Notification Service
â”‚   â”œâ”€â”€ package.json            # c4c serve Ğ² scripts
â”‚   â”œâ”€â”€ procedures/
â”‚   â”‚   â””â”€â”€ notifications.ts   # ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğ¹ + Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹
â”‚   â”œâ”€â”€ workflows/
â”‚   â”‚   â””â”€â”€ check-tasks.ts     # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ¸Ğ· App A
â”‚   â””â”€â”€ generated/             # ĞŸĞ¾ÑĞ»Ğµ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ App A
â”‚       â””â”€â”€ task-manager/
â”‚           â”œâ”€â”€ sdk.gen.ts
â”‚           â”œâ”€â”€ types.gen.ts
â”‚           â””â”€â”€ procedures.gen.ts
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ integrate-apps.sh      # ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ
â”‚   â””â”€â”€ test-integration.sh    # Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
â”‚
â””â”€â”€ README.md

Ğ’ĞĞ–ĞĞ: ĞĞµÑ‚ server.ts Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²!
ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ÑÑ‚ÑÑ Ñ‡ĞµÑ€ĞµĞ· c4c serve,
ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ ÑĞºĞ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ¾Ñ†ĞµĞ´ÑƒÑ€Ñ‹.
```

## Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚

ĞŸĞ¾ÑĞ»Ğµ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸:

1. âœ… App A Ğ¸Ğ¼ĞµĞµÑ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Ğ¿Ñ€Ğ¾Ñ†ĞµĞ´ÑƒÑ€Ğ°Ğ¼ App B
2. âœ… App B Ğ¸Ğ¼ĞµĞµÑ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Ğ¿Ñ€Ğ¾Ñ†ĞµĞ´ÑƒÑ€Ğ°Ğ¼ App A
3. âœ… ĞĞ±Ğ° Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ¼Ğ¾Ğ³ÑƒÑ‚ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°Ñ‚ÑŒÑÑ Ğ½Ğ° Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹ Ğ´Ñ€ÑƒĞ³ Ğ´Ñ€ÑƒĞ³Ğ°
4. âœ… Workflows Ğ¼Ğ¾Ğ³ÑƒÑ‚ ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ½Ğ¾ ĞºĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ†ĞµĞ´ÑƒÑ€Ñ‹ Ğ¸Ğ· Ğ¾Ğ±Ğ¾Ğ¸Ñ… Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹
5. âœ… ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ñ‚Ğ¸Ğ¿Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ TypeScript Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ¾Ğ²

**Ğ­Ñ‚Ğ¾ ÑĞ¾Ğ·Ğ´Ğ°ĞµÑ‚ ÑĞºĞ¾ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ñ… Ğ¼Ğ¸ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ² Ğ½Ğ° c4c!** ğŸ‰

## Ğ’Ğ°Ğ¶Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ñ

### âš ï¸ ĞĞµÑ‚ server.ts!

C4c Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ **Ğ½Ğµ ÑĞ¾Ğ·Ğ´Ğ°ÑÑ‚ ÑĞ²Ğ¾Ğ¹ server.ts**. Ğ’Ğ¼ĞµÑÑ‚Ğ¾ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ:

```bash
c4c serve --port 3001 --root .
```

**c4c serve Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸:**
- Ğ¡ĞºĞ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ `procedures/` Ğ¸ `workflows/`
- Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ Ğ²ÑĞµ Ğ¿Ñ€Ğ¾Ñ†ĞµĞ´ÑƒÑ€Ñ‹
- Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ registry
- Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ HTTP ÑĞµÑ€Ğ²ĞµÑ€
- Ğ Ğ°Ğ·Ğ´Ğ°ĞµÑ‚ `/openapi.json`

### ğŸ”œ Ğ‘ÑƒĞ´ÑƒÑ‰ĞµĞµ: c4c prune

Ğ”Ğ»Ñ production Ğ±ÑƒĞ´ĞµÑ‚ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° `c4c prune`, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ:
- Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµÑ‚ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
- Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ `server.gen.ts` Ñ ÑĞ²Ğ½Ñ‹Ğ¼Ğ¸ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ°Ğ¼Ğ¸
- Ğ£Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ Ñ…Ğ¾Ğ»Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ ÑÑ‚Ğ°Ñ€Ñ‚Ğ°

Ğ¡Ğ¼. `ARCHITECTURE.md` Ğ´Ğ»Ñ Ğ´ĞµÑ‚Ğ°Ğ»ĞµĞ¹.
